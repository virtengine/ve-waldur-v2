language: python
python:
- '2.7'
services:
- docker
before_install:
- sudo apt-get update -qq
- sudo apt-get install gcc libffi-dev libldap2-dev libsasl2-dev libssl-dev python-dev
install:
- pip install --upgrade -e .
- python setup.py install
script:
- python setup.py test
deploy:
- provider: pypi
  user: opennode
  password:
    secure: LaAtXIMb+uCRzWC+ypaIlnDD/857x2yBrYtCHdm087ithslFsCgnxPQuEepdfGuz80/BofU1FyjRThesfxkCbhJxfs2E3emsZcnpeMaPfbv1X2YmE8jHchSeAEc2Er1ERQEhyYh5544HZHZv0k3tBHJL77KRbT8ITyq2ujt4nxL2N2k4a24YsT2QmX5YfSuEH5W8vEcypN7oaA5EG49o9eyuTGm+4EG70QqCP9z7DTuubmogaKUWIXPvOVVrNUbgUrjM6Ap1PmVj3r0eF2CqQT8Xox9DRozHWFnM38XhnQGMfEO9c5a+XpHQrskPm94YdThYyBzipdlN+fvCsUpmsVjYoTwhOeFRYwqpAjzsqoYc5sF2iMrMyKkY5U98EU41L42yMF2VafaK1/5vYHCZhD2WldFVfC9F8OhE4jzM+z1oeT46ZNzLOqBnICq1C9MQeXjXQkDw/3MwWOfABZv9dLfBGpGXH8ay3GpyiAicsg9w3E3mMyT1Rn+eaeNEr8HMs7zSWB8UDAwlfPae+beNOIQRHQR6+hmIY1w4PnT5W/ItCS4QHGJozX6sjH8LoN+se+VxHvev4BE/d1nbgkybdDWgO4fecX9KE1rSlZ6LyauuayDnOChFnuPKxGUwRWqx2LzaI1B2cZ7E2GY6cUEgfiTnaaF90mfgGP9lZZmz5SM=
  on:
    tags: true
    repo: opennode/waldur-mastermind
  distributions: "sdist bdist_wheel"

- provider: script
  script: bash docker_push.sh
  on:
    branch: develop

- provider: script
  script: bash docker_push.sh
  on:
    tags: true

env:
  global:
  - secure: PDBFfnhoNCCCnkWNf2TJsTguy3dZlMfjFLqTNlhPDDgS8QwXqScF85r6sEj1uDToaWv5E8zbnSCfKDpDyHB3uRDgNdd8xUt/rx/dZjF63g0/DJEBHMd2pk4HsWHO0d2JDhubyAlBsfo1Db6cmGFQigBW+Y+V8Ny+C7+Dy7DkleeSFVFg2OS6kBYlXOZJtYLQumsFnMupMbvcej2wCXWNGfOMUtXaIE3iUTByRu0as4hVNFvd7jIX2+gcOAgmLX1W4wgPiG9NvaQAedoZZdRphAS7ycMmAZr6C2RfE51tOBHoy6dMibknJaafORg9f5U3k0RaaNx1vX5yyhwyAWrYlRP/HNzgwD8dMPWNMZzKJ6cJd79o6G7y7i7uUPC0sbuOKRsJR+cmpfVffgrrT/XfcZI6U61CFyffurIlkJAIcH6gixfmgkqSOi3mxwdRmyHjuecIH2U+Tpz2FOHEHj/VN2/VIx7cLaxEzhQ7vdY9dQB35obidM6voo35VN18Tip6/3KOcXUz98rhOdUeVsUUjp7Ubv/47f7srYj4dOLYQ7nwGYeEvWsTIwCdTdmo7lsOT6NMjUEFhC9iXxTaZXkUQj+3UIRo3LRlgQu9BmNXaXd6M8uDAb7BqTbUkzQrGUe3uLS1s6RoYO5Rxeh1f3kJo0T6L7s8I53DCB5dabE4UN0=
  - secure: YUkYCnOlcNKL5ii3kTCBwK/SmfNlao19yG1hMXxRrakvQ0+FPs2BxRH6Hoqxw371Ly6TYVG7nDguwqOZm7EZeB5IVE0NxzrB/Jb/iTqaRlq7/T8PZmnEdqMowZ1Rpwew1A7hhyfx9TqkC1a5EwJq4IgAlBDttx0hwVmTIzq2G3rCiNE+0jWf4wMRpmZYMsVUfku0313fNgcSeR9p4QKXlPDEoFWZFtJ5Yq0Imzyd0DrF2gZurK7DKgShc2hO5e/RayMI1gNqazTR3t96rIpp2QuaPdNh4kPM9DKDhr1BKcdLT4ielpom3uTVI7C0rYGA/N/DZugMNJgoSl2mc+861XRNNDrDT+WhdfxW4bvZI0NNUWgVNPhiEWO02oPyRdoJRmh3DLAk9cbQwU/5pTHFAfAsBUCY7It72YPmFDWxhb89f0HWBzTduA68qNSM+tqzdTkHu3rzb720gb/QkCCcZYBo0bOK+6LLnPsQPqTd6fNwSuGFZFv9ieUVA4ODjBAY005dzJIeYrjMePaLf7B4b8t8ToGiMvUVJL/gwgzQhGAHogecXIz96eX+XRgzfz/NcBP888nUha46vV0uzotIXTTOn2IzZ4RdOotxxDQxVDCipMeZeoNtLIcjmERQLU+BOxo6jgzYw8HzMnB/Y8Ha5dgb1T0ZbGBGXaSmkmN3s/E=
